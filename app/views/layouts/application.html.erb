<!DOCTYPE html>
<html>
  <head>
    <title>Pathfinder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= javascript_include_tag "https://maps.googleapis.com/maps/api/js?libraries=places&key=#{ENV['GOOGLE_API_KEY']}" %>
    <script type="text/javascript">
    function initialize() {
        var input = document.getElementById('searchTextField');
        var autocomplete = new google.maps.places.Autocomplete(input);
        google.maps.event.addListener(autocomplete, 'place_changed', function () {
            var place = autocomplete.getPlace();
            document.getElementById('trip_destination').value = place.name;
            document.getElementById('trip_latitude').value = place.geometry.location.lat();
            document.getElementById('trip_longitude').value = place.geometry.location.lng();
            // alert("This function is working!");
            // alert(place.name);
            // alert(place.address_components[0].long_name);
            // console.log(place.geometry.location.lat())
            // console.log(place.geometry.location.lng())
        });
    }
        google.maps.event.addDomListener(window, 'load', initialize);
    </script>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "custom", "data-turbo-track": "reload" %>

    <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>
    <%# <script async defer data-turbolinks-eval="false"
        src=<%="https://maps.googleapis.com/maps/api/js?key=#{ENV['GOOGLE_API_KEY']}&callback=initMap"%>>
    <%# </script> %>
  </head>

  <body>
    <%= render "shared/navbar" %>
    <%= render "shared/flashes" %>

    <%= yield %>
  </body>
</html>
